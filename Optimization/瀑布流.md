#### 基本概念
瀑布流，又被称作为瀑布流式布局，是一种比较流行的网站页面布局方式，视觉表现为参差不齐的多栏布局，随着页面滚动条向下滚动，这种布局还会不断加载数据块并附加至当前尾部。这种布局方式常见于一些图片为主的网站

#### 特征
内容框宽度固定，高度不固定。
内容框从左到右排列，一行排满后，其余内容框就会按顺序排在短的一列后。

#### 原理
首先我们先通过计算一行能够容纳几列元素（因为我们需要在不同的设备上浏览），然后在通过计算比较找出这一列元素中高度之和最小一列，然后将下一行的第一个元素添加至高度之和最小的这一列的下面，然后继续计算所有列中高度之和最小的那一列，然后继续将新元素添加至高度之和最小的那一列后面，直至所有元素添加完毕。

1. 首先我们放上一行div，它们高度不同，宽度相同
![avatar](https://pic2.zhimg.com/80/v2-908d8a1234ae536fb4881dc3414b2d8d_hd.jpg)

2. 找出所有元素高度之和的最小的那列在那一列的下面添加新的元素
![avatar](https://pic3.zhimg.com/80/v2-d51fe57f8472b6ad4edbbe8304ad6bda_hd.jpg)

3. 然后继续计算，获取高度之和最小的那一列，在那一列继续添加新元素
![avatar](https://pic4.zhimg.com/80/v2-908d8a1234ae536fb4881dc3414b2d8d_hd.jpg)

#### 实现
1. 通过浮动的方式进行布局（x）
2. 通过定位进行布局（√）
3. 判断一行有多少列：
* 获取到页面的宽度
* 获取到每个盒子的宽度
* 需要显示的列数 = 页面宽度/盒子宽度
> 注意：一般盒子之间都有一个间隙，所以我们的公式变成如下：显示的列数(column) = 页面宽度(pageWidth)/（盒子宽度(itemWidth)+间隙(gap)）
4. 排列第一行，使用数组管理
```
if (i < columns) {
    //确定第一行
    items[i].style.top = 0;
    items[i].style.left = (itemWidth + gap) * i + 'px';   
} 
```

5. 获取所有列的高度和:
> 我们需要计算出第一行所有列的高度和并保存。我们定义一个数组arr来保存高度。我们需要在页面一进入的时候就获取高度，也就是写在onload里面，因为图片的加载特征是：等页面都加载完之后才去请求加载，所以不写在入口函数里可能会出现高度获取不到的情况。请求图片后才知道其宽高

6. 排列第二行 
> 获取到刚刚数组中，高度最小的那一列，将第2行的第1个盒子放置在它的下方；此时的left值就是高度最小列的offsetLeft；top值就是第1行高度最小列的高度(为了布局美观可以加上上下间隙gap)。记录下高度最小列的索引index，高度最小列的高度加上下面盒子的高度，得出一个新高度，重新计算所有列的最小高度的列。

7. 设置为响应式
> 将整个设置样式的部分封装成一个函数，在onload里面注册一个resize事件，只要页面一发生改变，就触发样式部分的代码。实时改变pageWidth的宽度，这样瀑布流就会是一个响应式的效果了

HTMLElement.offsetWidth 是一个只读属性，返回一个元素的布局宽度。offsetWidth是测量包含元素的边框(border)、水平线上的内边距(padding)、竖直方向滚动条(scrollbar)（如果存在的话）、以及CSS设置的宽度(width)的值。
